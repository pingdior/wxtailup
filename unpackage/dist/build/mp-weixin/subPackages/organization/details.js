(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["subPackages/organization/details"],{2434:function(e,t,a){"use strict";a.r(t);var n=a("3e1b"),o=a.n(n);for(var s in n)"default"!==s&&function(e){a.d(t,e,(function(){return n[e]}))}(s);t["default"]=o.a},"3e1b":function(e,t,a){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(a("a34a")),o=a("26cb"),s=a("8d4b");function i(e){return e&&e.__esModule?e:{default:e}}function r(e,t,a,n,o,s,i){try{var r=e[s](i),l=r.value}catch(u){return void a(u)}r.done?t(l):Promise.resolve(l).then(n,o)}function l(e){return function(){var t=this,a=arguments;return new Promise((function(n,o){var s=e.apply(t,a);function i(e){r(s,n,o,i,l,"next",e)}function l(e){r(s,n,o,i,l,"throw",e)}i(void 0)}))}}function u(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?u(Object(a),!0).forEach((function(t){f(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function f(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var d=a("8141"),p=a("c1aa"),m=a("ac30"),g={name:"Details",data:function(){return{baseId:0,indicatorDots:!0,vertical:!1,autoplay:!1,interval:2e3,duration:500,active:0,baseInfo:{},orgHomeData:{animalBriefs:[],baseQas:[],canNum:0,catNum:0,dogNum:0,fanNum:0,focused:!1,followNum:0,headImgUrl:"",id:0,imageIds:[],name:"名称",userId:"0",deleteStatus:[]},animalApllies:[],applyListCur:0,applyListSize:10,applyPageCount:0,animalAplliesBaseInfos:[],noData:!1,upShareFileUrl:"",baseName:""}},computed:c(c({},(0,o.mapState)({appUserInfo:function(e){return e.user.userInfo}})),{},{isSelf:function(){return console.log("enter isSelf this.orgHomeData.userId === this.appUserInfo.id:",this.orgHomeData.userId,this.appUserInfo.id),this.orgHomeData&&this.orgHomeData.userId===this.appUserInfo.id},reverseAnimalBriefs:function(){if(this.orgHomeData&&this.orgHomeData.animalBriefs)return this.orgHomeData.animalBriefs.reverse()}}),methods:{initData:function(){var e=this;return l(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getOrgHomeInfo();case 2:return t.next=4,e.getOrgInfo();case 4:(0,s.isEmpty)(e.orgHomeData)||e.orgHomeData.userId!==e.appUserInfo.id||(console.log("before getAnimalApllies!"),e.getAnimalApllies(),e.baseName=e.orgHomeData.name,e.upShareFileUrl="/subPackages/organization/share?baseId="+e.orgHomeData.id+"&name="+e.orgHomeData.name);case 5:case"end":return t.stop()}}),t)})))()},onReachBottom:function(){if(console.log("enter onReachBottom applyListCur:",this.applyListCur),this.applyListCur>=this.applyPageCount)return this.noData=!0,void console.log("leave  onReachBottom noData:",this.noData);this.getAnimalApllies()},getAnimalApllies:function(){var e=this;return l(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("in getAnimalApllies!"),e.applyListCur+=1,t.next=4,m.getAdoptListOnBase({baseId:e.baseId,current:e.applyListCur,size:e.applyListSize}).then((function(t){if(console.log("getAnimalApllies is success:",t),!(0,s.isEmpty)(t.result)&&t.result.records.length>0)if(e.applyPageCount=t.result.pages,!(0,s.isEmpty)(e.animalApllies)&&e.animalApllies.length>0){var a=t.result.records;for(var n in a)e.animalApllies.push(a[n]),e.getApllyAnimalInfos(a[n].animalId);console.log("now animalApllies and animalAplliesBaseInfos counts:",e.animalApllies.length,e.animalAplliesBaseInfos.length)}else for(var o in e.animalApllies=t.result.records,e.animalApllies)e.getApllyAnimalInfos(e.animalApllies[o].animalId);else console.log("getAnimalApllies's records is null!"),e.noData=!0}));case 4:case"end":return t.stop()}}),t)})))()},getApllyAnimalInfos:function(e){var t=this;return l(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return console.log("getApllyAnimalInfos!"),a.next=3,p.getAnimalBasicInfo({animalId:e}).then((function(e){console.log("getAnimalBasicInfo is success:",e),(0,s.isEmpty)(e.result)||(0,s.isEmpty)(e.result.animal)?(console.log(" animalAplliesBaseInfos not add current animal!"),t.animalAplliesBaseInfos.push(null)):t.animalAplliesBaseInfos.push(e.result.animal)}));case 3:case"end":return a.stop()}}),a)})))()},getOrgHomeInfo:function(){var e=this;return l(n.default.mark((function t(){return n.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("getBaseHomeInfo!"),console.log(e.baseId),t.next=4,d.getBaseHomeInfo({baseId:e.baseId}).then((function(t){console.log("getBaseHomeInfo is success:",t),e.orgHomeData=t.result,e.orgHomeData.imageIds=t.result.imageIds.map((function(e){return e}))}));case 4:case"end":return t.stop()}}),t)})))()},getOrgInfo:function(){var e=this;console.log("getBaseInfo"),d.getBaseInfo({baseId:this.baseId}).then((function(t){console.log("getBaseInfo is success:",t),e.baseInfo=t.result}))},toAnimalDetails:function(t){e.navigateTo({url:"/subPackages/animal/details?id="+t.id+"&baseId="+this.baseId})},toAnimalAdoptDetails:function(t){return l(n.default.mark((function a(){return n.default.wrap((function(a){while(1)switch(a.prev=a.next){case 0:e.navigateTo({url:"/subPackages/organization/adoptDetail?applyId="+t.id+"&bFromMessage=false"});case 1:case"end":return a.stop()}}),a)})))()},toDelete:function(t,a){var n=this;console.log(t,a),e.showModal({content:"确定删除动物【"+t.name+"】吗？",success:function(a){a.confirm&&p.deleteAnimal({animalId:t.id}).then((function(t){t.success?(n.getOrgHomeInfo(),e.showToast({title:"删除成功"})):e.showToast({title:"删除失败"})}))}})},toAddAnimal:function(){e.navigateTo({url:"/subPackages/animal/animalEdit/newEdit?baseId="+this.baseId})},onChange:function(e){},toFocus:function(){var t=this;this.orgHomeData.focused=!this.orgHomeData.focused,d.baseFocus({baseId:this.baseId}).then((function(a){a.success?e.showToast({title:t.orgHomeData.focused?"关注成功":"取消关注"}):e.showToast({title:"操作失败"})}))},toEdit:function(){e.navigateTo({url:"/subPackages/organization/editForm?organizationId="+this.orgHomeData.id})},toAddFaq:function(){e.navigateTo({url:"./faqEdit?baseId=".concat(this.orgHomeData.id)})},onEdit:function(t,a){console.log(t,a),e.navigateTo({url:"./faqEdit?index=".concat(a,"&baseId=").concat(this.orgHomeData.id)})},onDelete:function(t,a){var n=this;e.showModal({title:"提示",content:"确定删除此答疑吗？",success:function(t){if(t.confirm){var o=JSON.parse(JSON.stringify(n.orgHomeData.baseQas));o.splice(a,1),console.log("list",o),d.postFaqItem({baseId:n.baseId,list:o}).then((function(t){console.log("删除结果",t),200===t.code&&(n.orgHomeData.baseQas.splice(a,1),e.showToast({title:"删除成功",icon:"success",duration:2e3}))}))}else t.cancel&&e.showToast({title:"取消删除",duration:2e3})}})},toShareBase:function(){console.log("enter shareBase!"),e.navigateTo({url:"./share?baseId=".concat(this.orgHomeData.id,"&name=").concat(this.orgHomeData.name)})}},mounted:function(){this.initData()},onLoad:function(e){console.log(e,"organ-options"),e.id&&(this.baseId=e.id)},onShareAppMessage:function(e){return"button"===e.from&&(console.log("enter onShareAppMessage:",e),console.log("enter onShareAppMessage upShareFileUrl:",this.upShareFileUrl)),{title:this.baseName+"的故事分享",path:this.upShareFileUrl}}};t.default=g}).call(this,a("543d")["default"])},"816e":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return n}));var n={uniCard:function(){return a.e("components/uni-card/uni-card").then(a.bind(null,"e20c"))}},o=function(){var e=this,t=e.$createElement;e._self._c},s=[]},a9a7:function(e,t,a){},ac02:function(e,t,a){"use strict";a.r(t);var n=a("816e"),o=a("2434");for(var s in o)"default"!==s&&function(e){a.d(t,e,(function(){return o[e]}))}(s);a("f2ae");var i,r=a("f0c5"),l=Object(r["a"])(o["default"],n["b"],n["c"],!1,null,null,null,!1,n["a"],i);t["default"]=l.exports},efd3:function(e,t,a){"use strict";(function(e){a("a09d");n(a("66fd"));var t=n(a("ac02"));function n(e){return e&&e.__esModule?e:{default:e}}wx.__webpack_require_UNI_MP_PLUGIN__=a,e(t.default)}).call(this,a("543d")["createPage"])},f2ae:function(e,t,a){"use strict";var n=a("a9a7"),o=a.n(n);o.a}},[["efd3","common/runtime","common/vendor"]]]);